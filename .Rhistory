year_color <- state_name_etymology %>%
filter(name != "Puerto Rico" & name != "District of Columbia") %>%
select(date_named) %>%
reframe(date_named = format(date_named, "%Y")) %>%
arrange(date_named) %>%
reframe(date_named = redondear_siglo(as.numeric(date_named)))
year_color <- state_name_etymology %>%
filter(state != "Puerto Rico" & state != "District of Columbia") %>%
select(date_named) %>%
reframe(date_named = format(date_named, "%Y")) %>%
arrange(date_named) %>%
reframe(date_named = redondear_siglo(as.numeric(date_named)))
year_color <- state_name_etymology %>%
filter(unique(state)) %>%
filter(state != "Puerto Rico" & state != "District of Columbia") %>%
select(date_named) %>%
reframe(date_named = format(date_named, "%Y")) %>%
arrange(date_named) %>%
reframe(date_named = redondear_siglo(as.numeric(date_named)))
year_color <- state_name_etymology %>%
filter(state != "Puerto Rico" & state != "District of Columbia") %>%
select(date_named, state) %>%
reframe(date_named = format(date_named, "%Y")) %>%
arrange(date_named) %>%
reframe(date_named = redondear_siglo(as.numeric(date_named)))
year_color <- state_name_etymology %>%
filter(state != "Puerto Rico" & state != "District of Columbia") %>%
select(date_named, state) %>%
group_by(state) %>%
reframe(date_named = format(date_named, "%Y")) %>%
arrange(date_named) %>%
reframe(date_named = redondear_siglo(as.numeric(date_named)))
year_color <- state_name_etymology %>%
filter(state != "Puerto Rico" & state != "District of Columbia") %>%
select(date_named, state) %>%
group_by(state) %>%
summarise(date_named = format(date_named, "%Y")) %>%
arrange(date_named) %>%
summarise(date_named = redondear_siglo(as.numeric(date_named)))
year_color <- state_name_etymology %>%
filter(state != "Puerto Rico" & state != "District of Columbia") %>%
select(date_named, state) %>%
group_by(state) %>%
reframe(date_named = format(date_named, "%Y")) %>%
arrange(date_named) %>%
group_by(state) %>%
reframe(date_named = redondear_siglo(as.numeric(date_named)))
year_color <- state_name_etymology %>%
filter(state != "Puerto Rico" & state != "District of Columbia") %>%
select(date_named, state) %>%
group_by(state) %>%
reframe(date_named = format(date_named, "%Y")) %>%
arrange(date_named) %>%
group_by(state) %>%
reframe(date_named = redondear_siglo(as.numeric(date_named))) %>%
group_by(state) %>%
reframe(date_named = sum(date_named) / n())
map$density <- year_color
map@data[["name"]]
map_2 <- map@data[-52,]
map@data <- map_2
rm(map_2)
map$density <- year_color
map <- geojsonio::geojson_read("https://rstudio.github.io/leaflet/json/us-states.geojson", what = "sp")
map_2 <- map@data[-52,]
map_2 <- map@data[-9,]
View(map_2)
map_2 <- map@data[-52,]
map_2 <- map_2[-9,]
map@data <- map_2
rm(map_2)
map$density <- year_color
map <- map %>%
rename(map$year = map$density)
map@data <- map@data %>%
rename(color = density)
map <- geojsonio::geojson_read("https://rstudio.github.io/leaflet/json/us-states.geojson", what = "sp")
map_2 <- map@data[-52,]
map_2 <- map_2[-9,]
map@data <- map_2
rm(map_2)
map$density <- year_color
map@data <- map@data %>%
rename(year = density)
bins <- c(1500, 1600, 1700, 1800)
nb.cols <- length(bins)
mycolors <- colorRampPalette(RColorBrewer::brewer.pal(4, "YlOrRd"))(nb.cols)
glimpse(mycolors)
map@data <- map@data %>%
mutate(year = as.numeric(year)) %>%
mutate(year = case_when(year == 1500 ~ mycolors[1],
year == 1600 ~ mycolors[2],
year == 1700 ~ mycolors[3],
year == 1800 ~ mycolors[4]))
map@data <- map@data %>%
select(-year$state) %>%
mutate(year = as.numeric(year)) %>%
mutate(year = case_when(year == 1500 ~ mycolors[1],
year == 1600 ~ mycolors[2],
year == 1700 ~ mycolors[3],
year == 1800 ~ mycolors[4]))
year_color <- state_name_etymology %>%
filter(state != "Puerto Rico" & state != "District of Columbia") %>%
select(date_named, state) %>%
group_by(state) %>%
reframe(date_named = format(date_named, "%Y")) %>%
arrange(date_named) %>%
group_by(state) %>%
reframe(date_named = redondear_siglo(as.numeric(date_named))) %>%
group_by(state) %>%
reframe(date_named = sum(date_named) / n()) %>%
select(date_named)
state_name_etymology <- readr::read_csv('https://raw.githubusercontent.com/rfordatascience/tidytuesday/master/data/2023/2023-08-01/state_name_etymology.csv')
library(tidyverse)
library(leaflet)
library(leaflet.extras)
library(leaflet.providers)
library(shiny)
library(rvest)
map <- geojsonio::geojson_read("https://rstudio.github.io/leaflet/json/us-states.geojson", what = "sp")
capitals <- read_csv("world_usa_coord.csv")
capitals <- capitals %>%
select(usa_state, usa_state_latitude, usa_state_longitude) %>%
filter(!is.na(usa_state)) %>%
rename(latitude = usa_state_latitude) %>%
rename(longitude = usa_state_longitude) %>%
rename(name = usa_state) %>%
filter(name != "Puerto Rico" & name != "District of Columbia")
state_name_etymology <- state_name_etymology %>%
rename(name = state) %>%
full_join(., capitals, by = "name")
redondear_siglo <- function(x) {
return(x - x %% 100)
}
year_color <- state_name_etymology %>%
filter(state != "Puerto Rico" & state != "District of Columbia") %>%
select(date_named, state) %>%
group_by(state) %>%
reframe(date_named = format(date_named, "%Y")) %>%
arrange(date_named) %>%
group_by(state) %>%
reframe(date_named = redondear_siglo(as.numeric(date_named))) %>%
group_by(state) %>%
reframe(date_named = sum(date_named) / n()) %>%
select(date_named)
year_color <- state_name_etymology %>%
filter(name != "Puerto Rico" & name != "District of Columbia") %>%
select(date_named, name) %>%
group_by(name) %>%
reframe(date_named = format(date_named, "%Y")) %>%
arrange(date_named) %>%
group_by(name) %>%
reframe(date_named = redondear_siglo(as.numeric(date_named))) %>%
group_by(name) %>%
reframe(date_named = sum(date_named) / n()) %>%
select(date_named)
map_2 <- map@data[-52,]
map_2 <- map_2[-9,]
map@data <- map_2
rm(map_2)
map$density <- year_color
map@data <- map@data %>%
rename(year = density)
state_name_etymology$meaning[6] <- "Probably named for the fictional Island of California ruled by Queen Calafia in the 16th-century novel Las sergas de Esplandián by Garci Rodríguez de Montalvo."
bins <- c(1500, 1600, 1700, 1800)
nb.cols <- length(bins)
mycolors <- colorRampPalette(RColorBrewer::brewer.pal(4, "YlOrRd"))(nb.cols)
map@data <- map@data %>%
mutate(year = as.numeric(year)) %>%
mutate(year = case_when(year == 1500 ~ mycolors[1],
year == 1600 ~ mycolors[2],
year == 1700 ~ mycolors[3],
year == 1800 ~ mycolors[4]))
state_name_etymology <- readr::read_csv('https://raw.githubusercontent.com/rfordatascience/tidytuesday/master/data/2023/2023-08-01/state_name_etymology.csv')
library(tidyverse)
library(leaflet)
library(leaflet.extras)
library(leaflet.providers)
library(shiny)
library(rvest)
map <- geojsonio::geojson_read("https://rstudio.github.io/leaflet/json/us-states.geojson", what = "sp")
capitals <- read_csv("world_usa_coord.csv")
capitals <- capitals %>%
select(usa_state, usa_state_latitude, usa_state_longitude) %>%
filter(!is.na(usa_state)) %>%
rename(latitude = usa_state_latitude) %>%
rename(longitude = usa_state_longitude) %>%
rename(name = usa_state) %>%
filter(name != "Puerto Rico" & name != "District of Columbia")
state_name_etymology <- state_name_etymology %>%
rename(name = state) %>%
full_join(., capitals, by = "name")
redondear_siglo <- function(x) {
return(x - x %% 100)
}
year_color <- state_name_etymology %>%
filter(name != "Puerto Rico" & name != "District of Columbia") %>%
select(date_named, name) %>%
group_by(name) %>%
reframe(date_named = format(date_named, "%Y")) %>%
arrange(date_named) %>%
group_by(name) %>%
reframe(date_named = redondear_siglo(as.numeric(date_named))) %>%
group_by(name) %>%
reframe(date_named = sum(date_named) / n()) %>%
select(date_named) %>%
mutate(date_named = case_when(date_named == 1500 ~ mycolors[1],
date_named == 1600 ~ mycolors[2],
date_named == 1700 ~ mycolors[3],
date_named == 1800 ~ mycolors[4]))
map_2 <- map@data[-52,]
map_2 <- map_2[-9,]
map@data <- map_2
rm(map_2)
map$density <- year_color
map@data <- map@data %>%
rename(color = density)
state_name_etymology$meaning[6] <- "Probably named for the fictional Island of California ruled by Queen Calafia in the 16th-century novel Las sergas de Esplandián by Garci Rodríguez de Montalvo."
base_map <- leaflet(map) %>%
setView(-96, 37.8, 4) %>%
addProviderTiles("CartoDB.PositronNoLabels") %>%
addTiles() %>%
addCircleMarkers(lng = ~capitals$longitude,
lat = ~capitals$latitude,
label = ~capitals$name,
layerId = ~capitals$name,
color = "#FF8900")
base_map <- leaflet(map) %>%
setView(-96, 37.8, 4) %>%
addProviderTiles("CartoDB.PositronNoLabels") %>%
addTiles() %>%
addCircleMarkers(lng = ~capitals$longitude,
lat = ~capitals$latitude,
label = ~capitals$name,
layerId = ~capitals$name,
color = map$color)
runApp()
base_map <- leaflet(map) %>%
setView(-96, 37.8, 4) %>%
addProviderTiles("CartoDB.PositronNoLabels") %>%
addTiles() %>%
addCircleMarkers(lng = ~capitals$longitude,
lat = ~capitals$latitude,
label = ~capitals$name,
layerId = ~capitals$name,
color = map$color,
stroke = FALSE)
runApp()
View(capitals)
capitals <- capitals %>%
full_join(., year_color)
capitals <- capitals %>%
mutate(colors = year_color)
year_color <- state_name_etymology %>%
filter(name != "Puerto Rico" & name != "District of Columbia") %>%
select(date_named, name) %>%
group_by(name) %>%
reframe(date_named = format(date_named, "%Y")) %>%
arrange(date_named) %>%
group_by(name) %>%
reframe(date_named = redondear_siglo(as.numeric(date_named))) %>%
group_by(name) %>%
reframe(date_named = sum(date_named) / n()) %>%
select(date_named) %>%
mutate(date_named = case_when(date_named == 1500 ~ mycolors[1],
date_named == 1600 ~ mycolors[2],
date_named == 1700 ~ mycolors[3],
date_named == 1800 ~ mycolors[4])) %>%
rename(color = date_named)
capitals <- capitals %>%
mutate(colors = year_color)
capitals <- capitals %>%
mutate(color = year_color)
capitals <- capitals %>%
mutate(color = year_color) %>%
rename(color = color$color)
glimpse(capitals)
capitals <- read_csv("world_usa_coord.csv")
capitals <- capitals %>%
select(usa_state, usa_state_latitude, usa_state_longitude) %>%
filter(!is.na(usa_state)) %>%
rename(latitude = usa_state_latitude) %>%
rename(longitude = usa_state_longitude) %>%
rename(name = usa_state) %>%
filter(name != "Puerto Rico" & name != "District of Columbia")
capitals <- capitals %>%
mutate(color = year_color)
View(capitals)
runApp()
runApp()
base_map <- leaflet(map) %>%
setView(-96, 37.8, 4) %>%
addProviderTiles("CartoDB.PositronNoLabels") %>%
addTiles() %>%
addCircleMarkers(lng = ~capitals$longitude,
lat = ~capitals$latitude,
label = ~capitals$name,
layerId = ~capitals$name,
color = ~capitals$color,
stroke = FALSE) %>%
addLegend(pal = mycolors, values = bins, opacity = 1)
base_map <- leaflet(map) %>%
setView(-96, 37.8, 4) %>%
addProviderTiles("CartoDB.PositronNoLabels") %>%
addTiles() %>%
addCircleMarkers(lng = ~capitals$longitude,
lat = ~capitals$latitude,
label = ~capitals$name,
layerId = ~capitals$name,
color = ~capitals$color,
stroke = FALSE) %>%
addLegend(pal = mycolors, values = ~bins, opacity = 1)
base_map <- leaflet(map) %>%
setView(-96, 37.8, 4) %>%
addProviderTiles("CartoDB.PositronNoLabels") %>%
addTiles() %>%
addCircleMarkers(lng = ~capitals$longitude,
lat = ~capitals$latitude,
label = ~capitals$name,
layerId = ~capitals$name,
color = ~capitals$color,
stroke = FALSE)
state_name_etymology <- readr::read_csv('https://raw.githubusercontent.com/rfordatascience/tidytuesday/master/data/2023/2023-08-01/state_name_etymology.csv')
library(tidyverse)
library(leaflet)
library(leaflet.extras)
library(leaflet.providers)
library(shiny)
library(rvest)
map <- geojsonio::geojson_read("https://rstudio.github.io/leaflet/json/us-states.geojson", what = "sp")
capitals <- read_csv("world_usa_coord.csv")
capitals <- capitals %>%
select(usa_state, usa_state_latitude, usa_state_longitude) %>%
filter(!is.na(usa_state)) %>%
rename(latitude = usa_state_latitude) %>%
rename(longitude = usa_state_longitude) %>%
rename(name = usa_state) %>%
filter(name != "Puerto Rico" & name != "District of Columbia")
state_name_etymology <- state_name_etymology %>%
rename(name = state) %>%
full_join(., capitals, by = "name")
redondear_siglo <- function(x) {
return(x - x %% 100)
}
bins <- c(1500, 1600, 1700, 1800)
nb.cols <- length(bins)
mycolors <- colorRampPalette(RColorBrewer::brewer.pal(4, "YlOrRd"))(nb.cols)
year_color <- state_name_etymology %>%
filter(name != "Puerto Rico" & name != "District of Columbia") %>%
select(date_named, name) %>%
group_by(name) %>%
reframe(date_named = format(date_named, "%Y")) %>%
arrange(date_named) %>%
group_by(name) %>%
reframe(date_named = redondear_siglo(as.numeric(date_named))) %>%
group_by(name) %>%
reframe(date_named = sum(date_named) / n()) %>%
select(date_named) %>%
mutate(date_named = case_when(date_named == 1500 ~ mycolors[1],
date_named == 1600 ~ mycolors[2],
date_named == 1700 ~ mycolors[3],
date_named == 1800 ~ mycolors[4])) %>%
rename(color = date_named)
map_2 <- map@data[-52,]
map_2 <- map_2[-9,]
map@data <- map_2
rm(map_2)
map$density <- year_color
map@data <- map@data %>%
rename(color = density)
pal <- colorBin(mycolors, domain = map$color, bins = bins)
capitals <- capitals %>%
mutate(color = year_color)
state_name_etymology$meaning[6] <- "Probably named for the fictional Island of California ruled by Queen Calafia in the 16th-century novel Las sergas de Esplandián by Garci Rodríguez de Montalvo."
base_map <- leaflet(map) %>%
setView(-96, 37.8, 4) %>%
addProviderTiles("CartoDB.PositronNoLabels") %>%
addTiles() %>%
addCircleMarkers(lng = ~capitals$longitude,
lat = ~capitals$latitude,
label = ~capitals$name,
layerId = ~capitals$name,
color = ~capitals$color,
stroke = FALSE) %>%
addLegend(pal = mycolors, values = ~bins, opacity = 1)
base_map <- leaflet(map) %>%
setView(-96, 37.8, 4) %>%
addProviderTiles("CartoDB.PositronNoLabels") %>%
addTiles() %>%
addCircleMarkers(lng = ~capitals$longitude,
lat = ~capitals$latitude,
label = ~capitals$name,
layerId = ~capitals$name,
color = ~capitals$color,
stroke = FALSE) %>%
addLegend(pal = pal, values = ~bins, opacity = 1)
runApp()
base_map <- leaflet(map) %>%
setView(-96, 37.8, 4) %>%
addProviderTiles("CartoDB.PositronNoLabels") %>%
addTiles() %>%
addCircleMarkers(lng = ~capitals$longitude,
lat = ~capitals$latitude,
label = ~capitals$name,
layerId = ~capitals$name,
color = ~pal(color),
stroke = FALSE) %>%
addLegend(pal = pal, values = ~bins, opacity = 1, title = NULL,
position = "bottomright")
base_map <- leaflet(map) %>%
setView(-96, 37.8, 4) %>%
addProviderTiles("CartoDB.PositronNoLabels") %>%
addTiles() %>%
addCircleMarkers(lng = ~capitals$longitude,
lat = ~capitals$latitude,
label = ~capitals$name,
layerId = ~capitals$name,
color = ~pal(map$color),
stroke = FALSE) %>%
addLegend(pal = pal, values = ~bins, opacity = 1, title = NULL,
position = "bottomright")
year_color <- state_name_etymology %>%
filter(name != "Puerto Rico" & name != "District of Columbia") %>%
select(date_named, name) %>%
group_by(name) %>%
reframe(date_named = format(date_named, "%Y")) %>%
arrange(date_named) %>%
group_by(name) %>%
reframe(date_named = redondear_siglo(as.numeric(date_named))) %>%
group_by(name) %>%
reframe(date_named = sum(date_named) / n()) %>%
select(date_named) %>%
rename(color = date_named)
map <- geojsonio::geojson_read("https://rstudio.github.io/leaflet/json/us-states.geojson", what = "sp")
map_2 <- map@data[-52,]
map_2 <- map_2[-9,]
map@data <- map_2
rm(map_2)
map$density <- year_color
map@data <- map@data %>%
rename(color = density)
pal <- colorBin(mycolors, domain = map$color, bins = bins)
base_map <- leaflet(map) %>%
setView(-96, 37.8, 4) %>%
addProviderTiles("CartoDB.PositronNoLabels") %>%
addTiles() %>%
addCircleMarkers(lng = ~capitals$longitude,
lat = ~capitals$latitude,
label = ~capitals$name,
layerId = ~capitals$name,
color = ~pal(map$color),
stroke = FALSE) %>%
addLegend(pal = pal, values = ~bins, opacity = 1, title = NULL,
position = "bottomright")
map <- geojsonio::geojson_read("https://rstudio.github.io/leaflet/json/us-states.geojson", what = "sp")
year_color <- state_name_etymology %>%
filter(name != "Puerto Rico" & name != "District of Columbia") %>%
select(date_named, name) %>%
group_by(name) %>%
reframe(date_named = format(date_named, "%Y")) %>%
arrange(date_named) %>%
group_by(name) %>%
reframe(date_named = redondear_siglo(as.numeric(date_named))) %>%
group_by(name) %>%
reframe(date_named = sum(date_named) / n()) %>%
select(date_named) %>%
rename(color = date_named)
map_2 <- map@data[-52,]
map_2 <- map_2[-9,]
map@data <- map_2
rm(map_2)
map$density <- year_color$color
map@data <- map@data %>%
rename(color = density)
pal <- colorBin(mycolors, domain = map$color, bins = bins)
base_map <- leaflet(map) %>%
setView(-96, 37.8, 4) %>%
addProviderTiles("CartoDB.PositronNoLabels") %>%
addTiles() %>%
addCircleMarkers(lng = ~capitals$longitude,
lat = ~capitals$latitude,
label = ~capitals$name,
layerId = ~capitals$name,
color = ~pal(map$color),
stroke = FALSE) %>%
addLegend(pal = pal, values = ~bins, opacity = 1, title = NULL,
position = "bottomright")
runApp()
runApp()
runApp()
runApp()
runApp()
remotes::install_version("rsconnect", "0.8.29")
runApp()
install.packages("shinyjs")
install.packages("waiter")
library(waiter)
shiny::runApp('2023/2023_09_05/USA_Union_Members')
waiting_screen <- tagList(
spin_flower(),
h4("App loading...")
)
runApp('2023/2023_09_05/USA_Union_Members')
runApp('2023/2023_09_05/USA_Union_Members')
runApp('2023/2023_09_05/USA_Union_Members')
waiting_screen <- tagList(
spin_flower(),
h4("App loading...")
)
runApp('2023/2023_09_05/USA_Union_Members')
runApp('2023/2023_09_05/USA_Union_Members')
runApp('2023/2023_09_05/USA_Union_Members')
